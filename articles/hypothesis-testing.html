<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hypothesis Testing • twoxtwo</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Hypothesis Testing">
<meta property="og:description" content="twoxtwo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">twoxtwo</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/af-impact.html">Attributable Fractions and Impact Numbers</a>
    </li>
    <li>
      <a href="../articles/basic-usage.html">Basic Usage</a>
    </li>
    <li>
      <a href="../articles/hypothesis-testing.html">Hypothesis Testing</a>
    </li>
    <li>
      <a href="../articles/measures-of-effect.html">Measures of Effect</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hypothesis-testing_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Hypothesis Testing</h1>
            
      
      
      <div class="hidden name"><code>hypothesis-testing.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>While exploring the relationship between an exposure and an outcome it may be useful to statistically test the strength of association. Hypothesis testing is a statistical inference technique by which one uses observed sample data to interrogate an assumption about a population parameter. Given an assumed probability distribution for the population parameter, a hypothesis test can yield a measure of how likely it would be to encounter the data observed. Two of the hypothesis tests applied to count data in two-by-two tables include Pearson’s chi-squared test and Fisher’s exact test. Both of these techniques are implemented in the <code>twoxtwo</code> package. The narrative that follows demonstrates how to perform these tests using example datasets created below as well as the <code>titanic</code> data that ships with <code>twoxtwo</code> <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
</div>
<div id="pearsons-chi-squared-test" class="section level2">
<h2 class="hasAnchor">
<a href="#pearsons-chi-squared-test" class="anchor"></a>Pearson’s Chi-squared test</h2>
<p>With data organized in a contingency table it is possible to test independence of counts in each cell. At a given cell, one can compare the observed count (<span class="math inline">\(n_{ij}\)</span>) and expected count (<span class="math inline">\(\mu_{ij}\)</span>) and arrive at the following test statistic:</p>
<p><span class="math display">\[\chi^2 = \sum \frac{(n_{ij}-\mu_{ij})^2}{\mu_{ij}}\]</span> The Pearson’s <span class="math inline">\(\chi^2\)</span> (chi-squared) statistic above is parameterized by degrees of freedom. A contingency table has degrees of freedom computed as (number or rows - 1 ) * (number of columns - 1). For a two-by-two table (2 rows, 2 columns), <span class="math inline">\(\chi^2\)</span> will have 1 degree of freedom.</p>
<p>The <span class="math inline">\(\chi^2\)</span> test statistic and its degrees of freedom can be used in a hypothesis test. If the probability of observing a statistic as large is less than the stated significance level (<span class="math inline">\(\alpha\)</span>) then one can reject the null hypothesis of independence among cell counts.</p>
<p>Pearson’s <span class="math inline">\(\chi^2\)</span> test is implemented in R via the <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> function in the <code>stats</code> package. The <code>twoxtwo</code> package wraps this functionality in its <code><a href="../reference/chisq.html">chisq()</a></code> function. One of the advantages of <code><a href="../reference/chisq.html">chisq()</a></code> as opposed to <code><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test()</a></code> is that the <code>twoxtwo</code> implementation returns a tidy hypothesis test output.</p>
<p>Below is an example of using the <code><a href="../reference/chisq.html">chisq()</a></code> function to explore the association between crew status and survival in the <code>titanic</code> dataset:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">twoxtwo</span><span class="op">)</span>

<span class="va">titanic</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/chisq.html">chisq</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">Crew</span>, <span class="va">Survived</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test      estimate ci_lower ci_upper statistic    df   pvalue exposure outcome</span>
<span class="co">#   &lt;chr&gt;     &lt;lgl&gt;    &lt;lgl&gt;    &lt;lgl&gt;        &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;  </span>
<span class="co"># 1 Pearson'… NA       NA       NA            46.5     1 8.97e-12 Crew::T… Surviv…</span></code></pre></div>
</div>
<div id="fishers-exact-test" class="section level2">
<h2 class="hasAnchor">
<a href="#fishers-exact-test" class="anchor"></a>Fisher’s exact test</h2>
<p>Another method for testing independence between two-by-two cell counts is Fisher’s exact test. After fixing marginal row and column totals, one can cycle through possible combinations of cell counts that would sum to those margins. Each combination yields a unique two-by-two table. For each of these tables the binomial probability of observing the given count in cell A<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> can be expressed as:</p>
<p><span class="math display">\[p=\frac{(A+B)!\times{(C+D)!}\times{(A+C)!}\times{(B+D)!}}{A!\times{B!}\times{C!}\times{D!}}\]</span></p>
<p>To calculate a p-value, one can sum the probabilities for cell counts that are at least as extreme as the observed count. Using this method there is no need for a test statistic since the p-value can be calculated <em>exactly</em> as the sum of binomial probabilities.</p>
<p>The stated origin of Fisher’s exact test is the “tea taster” experiment. The design is detailed in the example below:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>

<span class="va">tea</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">poured</span>, <span class="op">~</span><span class="va">guessed</span>, <span class="op">~</span> <span class="va">n</span>,
    <span class="st">"Milk"</span>, <span class="st">"Milk"</span>, <span class="fl">3</span>,
    <span class="st">"Milk"</span>, <span class="st">"Tea"</span>, <span class="fl">1</span>,
    <span class="st">"Tea"</span>, <span class="st">"Milk"</span>, <span class="fl">1</span>,
    <span class="st">"Tea"</span>, <span class="st">"Tea"</span>, <span class="fl">3</span>
    <span class="op">)</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/uncount.html">uncount</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>

<span class="va">tea</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/twoxtwo.html">twoxtwo</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">poured</span>, <span class="va">guessed</span>, 
          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milk"</span>,<span class="st">"Tea"</span><span class="op">)</span>, outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milk"</span>,<span class="st">"Tea"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># |         |            |OUTCOME      |OUTCOME     |</span>
<span class="co"># |:--------|:-----------|:------------|:-----------|</span>
<span class="co"># |         |            |guessed=Milk |guessed=Tea |</span>
<span class="co"># |EXPOSURE |poured=Milk |3            |1           |</span>
<span class="co"># |EXPOSURE |poured=Tea  |1            |3           |</span></code></pre></div>
<p>To conduct the hypothesis test with the <code><a href="../reference/fisher.html">fisher()</a></code> function from the <code>twoxtwo</code> package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tea</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/fisher.html">fisher</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">poured</span>, <span class="va">guessed</span>, 
         levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milk"</span>,<span class="st">"Tea"</span><span class="op">)</span>, outcome <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Milk"</span>,<span class="st">"Tea"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test      estimate ci_lower ci_upper statistic df    pvalue exposure  outcome </span>
<span class="co">#   &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   </span>
<span class="co"># 1 Fisher's…     6.41    0.212     622. NA        NA     0.486 poured::… guessed…</span></code></pre></div>
<p>As with <code><a href="../reference/chisq.html">chisq()</a></code> the <code><a href="../reference/fisher.html">fisher()</a></code> function wraps a function from the <code>stats</code> package. <code><a href="../reference/fisher.html">fisher()</a></code> passes arguments for the proposed odds ratio for the hypothesis testing, confidence level for odds ratio estimate, and alternative hypothesis into the interal <code><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test()</a></code> function. Examples of several of these parameters in practice are provided below to explore the association between crew status and survival in the <code>titanic</code> dataset:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">titanic</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/fisher.html">fisher</a></span><span class="op">(</span><span class="va">.</span>, exposure <span class="op">=</span> <span class="va">Crew</span>, outcome <span class="op">=</span> <span class="va">Survived</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test      estimate ci_lower ci_upper statistic df    pvalue exposure  outcome </span>
<span class="co">#   &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;  &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;   </span>
<span class="co"># 1 Fisher's…    0.516    0.437      Inf NA        NA      1.00 Crew::TR… Survive…</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">titanic</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/fisher.html">fisher</a></span><span class="op">(</span><span class="va">.</span>, exposure <span class="op">=</span> <span class="va">Crew</span>, outcome <span class="op">=</span> <span class="va">Survived</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test     estimate ci_lower ci_upper statistic df      pvalue exposure  outcome</span>
<span class="co">#   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  </span>
<span class="co"># 1 Fisher'…    0.516        0    0.608 NA        NA    2.71e-12 Crew::TR… Surviv…</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">titanic</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/fisher.html">fisher</a></span><span class="op">(</span><span class="va">.</span>, exposure <span class="op">=</span> <span class="va">Crew</span>, outcome <span class="op">=</span> <span class="va">Survived</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test     estimate ci_lower ci_upper statistic df      pvalue exposure  outcome</span>
<span class="co">#   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  </span>
<span class="co"># 1 Fisher'…    0.516    0.424    0.626 NA        NA    5.19e-12 Crew::TR… Surviv…</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">titanic</span> <span class="op"><a href="../reference/%&gt;%.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/fisher.html">fisher</a></span><span class="op">(</span><span class="va">.</span>, exposure <span class="op">=</span> <span class="va">Crew</span>, outcome <span class="op">=</span> <span class="va">Survived</span>, or <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co"># # A tibble: 1 × 9</span>
<span class="co">#   test     estimate ci_lower ci_upper statistic df      pvalue exposure  outcome</span>
<span class="co">#   &lt;chr&gt;       &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;lgl&gt;     &lt;lgl&gt;    &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;  </span>
<span class="co"># 1 Fisher'…    0.516    0.424    0.626 NA        NA    9.98e-47 Crew::TR… Surviv…</span></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<blockquote>
<p>Agresti, A. (2019). An Introduction to Categorical Data Analysis. Hoboken, New Jersey: Wiley and Sons.</p>
</blockquote>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>For more details on see <code><a href="../reference/titanic.html">?titanic</a></code><a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>The notation here is described in detail in the <code>twoxtwo</code> “Basic Usage” vignette. To read the vignette: <code><a href="../articles/basic-usage.html">vignette("basic-usage", package = "twoxtwo")</a></code><a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by VP Nagraj.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
